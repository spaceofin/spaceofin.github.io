<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/_next/static/css/ec8169d84bc91095.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-cceda007551b34ac.js"/><script src="/_next/static/chunks/fd9d1056-42bca7a501e26700.js" async=""></script><script src="/_next/static/chunks/23-0400f1ada3445968.js" async=""></script><script src="/_next/static/chunks/main-app-e0d78c455d046f20.js" async=""></script><script src="/_next/static/chunks/231-6a7b6dfd7bcbf59a.js" async=""></script><script src="/_next/static/chunks/app/layout-c9173ec0898b2734.js" async=""></script><title>Spaceofin Logs</title><meta name="description" content="A blog for study logs"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="256x256"/><script src="/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js" noModule=""></script></head><body><nav class="font-mono mx-16"><ul class="relative min-h-32 mt-14 mb-10 mx-2 sm:mx-12 lg:mx-14 flex flex-col md:flex-row md:space-x-12 lg:space-x-16 space-y-1 md:space-y-0 justify-center md:justify-start items-start sm:items-center md:items-center text-2xl md:text-3xl z-0 tracking-tight text-zinc-900 pl-4 sm:pl-0"><li><a href="/">Home</a></li><li><a href="/learning-logs">Learning Logs</a></li><li><a href="/commit-logs">Commit Logs</a></li></ul></nav><div class="flex justify-center py-10"><div class="page-background"><div class="flex flex-col prose dark:prose-invert w-full h-full max-h-none overflow-visible px-4"><h1 class="my-20 text-4xl">리액트 JS 프로젝트(animal-friends) 리팩토링</h1>
<p>프로젝트 주소</p>
<pre><code>https://animal-friends-ts.netlify.app
</code></pre>
<p>animal freidns 애플리케이션은 React 학습 후 처음 만든 포트폴리오 프로젝트입니다.</p>
<p>CRA로 생성한 React JS 프로젝트이며 기능이 작동하는 것에 주안점을 두고 구축하다 보니 내부 구조가 좋지 못했습니다. 애플리케이션의 더 매끄러운 작동을 위해 리팩토링을 하기로 합니다.</p>
<p>리팩토링 과정은 아래의 단계로 진행하였습니다.</p>
<pre><code>1. Vite 프로젝트 생성 및 환경 변수 수정
2. javascript 파일들을 typescript 파일로 변환(일단 작동하게만)
3. UserContext과 useAuth hook 코드 정리
</code></pre>
<h2 class="mt-20 text-3xl text-blue-900">1. Vite 프로젝트 생성 및 환경 변수 수정</h2>
<p>기존의 프로젝트는 CRA으로 만든 프로젝트였으나 리팩토링 프로젝트는 Vite를 사용하였습니다.</p>
<p><code>REACT_APP_</code>으로 시작하던 환경 변수들을 <code>VITE_</code>로 시작하도록, <code>process.env.</code> 접두어를 붙여 사용하던 환경 변수들은 <code>import.meta.env.</code> 접두어를 사용하도록 수정하였습니다.</p>
<h2 class="mt-20 text-3xl text-blue-900">2. javascript 파일들을 typescript 파일로 변환</h2>
<p>프로젝트 내 <code>js</code>, <code>jsx</code> 파일들의 확장자를 <code>ts</code>, <code>tsx</code> 확장자로 변경하였으며, 타입스크립트 파일들 내에 필요한 타입들을 추가해주었습니다.</p>
<p>파일 확장자 변경 후 코드 수정이 필요했던 부분들은 다음과 같습니다.</p>
<h3 class="text-2xl dark:text-2xl text-sky-700 dark:text-sky-300">import 구문에서 확장자 없는 json 파일을 인식하지 못하는 문제</h3>
<p>기존 프로젝트는 commonJS 모듈 방식의 프로젝트였고, 새로 생성한 Vite 프로젝트는 ESM 방식의 모듈 시스템을 사용합니다.<br/>
<!-- -->Vite의 경우&#x27;.mjs&#x27;, &#x27;.js&#x27;, &#x27;.mts&#x27;, &#x27;.ts&#x27;, &#x27;.jsx&#x27;, &#x27;.tsx&#x27;, &#x27;.json&#x27; 확장자를 생략하여도 자동으로 파일을 인식하지만 타입스크립트 프로젝트인 경우에는 &#x27;.ts&#x27;, &#x27;.tsx&#x27; 확장자 인식이 가능하며 <code>.json</code>이나 <code>.css</code> 등과 같은 이외의 확장자는 필수로 명시해주어야 합니다.</p>
<p><code>.json</code> 확장자를 명시적으로 import 구문에 추가합니다.</p>
<pre><code>// before
import demoDetails from &quot;data/demoDetails&quot;;
</code></pre>
<pre><code>// after
import demoDetails from &quot;data/demoDetails.json&quot;;
</code></pre>
<h3 class="text-2xl dark:text-2xl text-sky-700 dark:text-sky-300">Vite 프로젝트에서 svg 파일을 사용하기 위한 설정 추가</h3>
<p><code>svgr</code>이 내장되어 있던 CRA 프로젝트와 달리 Vite 프로젝트의 경우 svg 파일의 사용을 위해 svgr를 따로 설치해야 합니다.</p>
<pre><code>// vite-plugin-svgr 설치
npm install --save-dev vite-plugin-svgr
</code></pre>
<pre><code>// vite.config.ts
...
import svgr from &quot;vite-plugin-svgr&quot;;

export default defineConfig({
  plugins: [..., svgr()],
});
</code></pre>
<p>또한 CRA 프로젝트 에서는 <code>ReactComponent</code>라는 이름으로 named export를 진행하였으나, Vite 프로젝트에서는 svg를 default export 방식으로 사용하며 파일명 끝에 <code>?react</code> 라는 쿼리 파라미터를 붙여 svgr 적용을 요청합니다.</p>
<pre><code>// CRA
export { ReactComponent as Logout } from &quot;./sidebar/logout.svg&quot;;

// Vite
export { default as Logout } from &quot;./sidebar/logout.svg?react&quot;;
</code></pre>
<h2 class="mt-20 text-3xl text-blue-900">3. UserContext과 useAuth hook 코드 정리</h2>
<p>기존 코드에서의 문제점은 auth 관련 로직이 UserContext와 useAuth hook에 섞여 정리가 되어 있지 않았다는 점입니다. 또한 userContext에서 불필요하게 많은 변수를 사용하고 있었으며, user 정보에 포함되는 중복 변수들도 있었습니다.</p>
<h3 class="text-2xl dark:text-2xl text-sky-700 dark:text-sky-300">3-1. UserContext 코드 정리</h3>
<p>먼저 UserContext 파일의 코드를 정리해줍니다.</p>
<pre><code>// before
export const UserProvider = ({ children }: { children: React.ReactNode }) =&gt; {
	...
	return (
		&lt;UserContext.Provider
		      value={{
		        user,
		        setUser,
		        userLogin,
		        userLogout,
		        profileAnimal,
		        setProfileAnimal,
		        postCount,
		        friendsCount,
		        setNewDisplayName,
		        createUserDoc,
		        updateUserCollectionData,
		        likePosts,
		      }}&gt;
		    {children}
		&lt;/UserContext.Provider&gt;
	);
};
</code></pre>
<p>코드를 리팩토링하면서 UserContext에서는 로그인한 유저 정보와 현재 로그인한 상태인지만 다루도록 하였습니다.<br/>
<!-- -->user 데이터와 중복되는 값들은 없애고 user 값에서만 데이터를 갖다 쓰도록 하였습니다.</p>
<pre><code>// after
export const UserProvider = ({ children }: { children: React.ReactNode }) =&gt; {
	...
	return (
	    &lt;UserContext.Provider value={{ user, setUser, isLoggedIn }}&gt;
	      {children}
	    &lt;/UserContext.Provider&gt;
	);
};
</code></pre>
<p>이 과정에서 userContext 파일 내에서 함께 처리하던 User 정보와 관련된 로직들은 별도의 userService 파일을 생성하여 모아 두었습니다.</p>
<pre><code>// userServices.ts

const getUserDocumentByUid = async (userId: string) =&gt; { ... };
export const createUser = async ({ ... });
export const getUser = async (userId: string) =&gt; { ... };
export const updateUserProfileAnimal = async (uid: string, profileAnimal: string) =&gt; { ... };
export const updateUserName = async (uid: string, userName: string) =&gt; { ... };
export const updateUserLikePosts = async (uid: string, likePosts: string[]) =&gt; { ... };

</code></pre>
<h3 class="text-2xl dark:text-2xl text-sky-700 dark:text-sky-300">3-2. useAuth hook 코드 정리</h3>
<p>먼저, 유저의 로그인 상태에 대한 정보는 UserContext에서 관리하도록 하였으므로 useAuth hook에서는 삭제하였습니다.(<code>isLoggedIn</code>)<br/>
<!-- -->또한 프로젝트에 기존 useAuth hook에서는 이메일 로그인 로직만을 다루며 social login의 경우 login 페이지의 코드에서 수행하였으나 리팩토링 하며 로그인 관련 로직들을 모아서 useAuth hook에 정리하였습니다.</p>
<pre><code>// before 
export const useAuth = () =&gt; {
	const { user, setUser } = useUser();
	...

	const isLoggedIn = user !== null;
	const login = async (email, password) =&gt; {
		// email-password login logic
		...
	}
	...
	
	return { user, login, logout, isLoggedIn };
}
</code></pre>
<pre><code>// after
export const useAuth = () =&gt; {
	const { setUser } = useUser();
	...

	const loginWithEmail = async (email: string, password: string) =&gt; {
		// email-password login logic
		...
	}
	const loginWithSocial = async (authProvider: string) =&gt; {
		// social login logic
		...
	}

	return { loginWithEmail, loginWithSocial, logout };
}
</code></pre>
<h3 class="text-2xl dark:text-2xl text-sky-700 dark:text-sky-300">3-3. UserContext와 useAuth hook을 사용하는 관련 코드 업데이트</h3>
<p>변경된 UserContext와 useAuth hook에 맞게 관련 코드들도 수정하였습니다.</p>
<p>useAuth로부터 가져다 쓰던 로그인 상태 확인 로직을 useUser를 사용하도록 변경하였습니다.</p>
<pre><code>// before
const { isLoggedIn } = useAuth();

// after
const { isLoggedIn } = useUser();
</code></pre>
<p>useAuth로부터 email-password 방식의 로그인 함수만 가져오고 social login은 해당 페이지에서 구현하던 방식을 두 가지 방식의 로그인 함수 다 useAuth 로부터 가져다 쓰도록 변경하였습니다.</p>
<pre><code>// before
const { login } = useAuth();

// after
const { loginWithEmail, loginWithSocial } = useAuth();
</code></pre>
<h2 class="mt-20 text-3xl text-blue-900">reference</h2>
<pre><code>https://vite.dev/config/shared-options.html#resolve-extensions
</code></pre></div></div></div><script src="/_next/static/chunks/webpack-cceda007551b34ac.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/css/ec8169d84bc91095.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"2:I[5751,[],\"\"]\n5:I[9275,[],\"\"]\n7:I[1343,[],\"\"]\n8:I[5767,[\"231\",\"static/chunks/231-6a7b6dfd7bcbf59a.js\",\"185\",\"static/chunks/app/layout-c9173ec0898b2734.js\"],\"PostProvider\",1]\n9:I[231,[\"231\",\"static/chunks/231-6a7b6dfd7bcbf59a.js\",\"185\",\"static/chunks/app/layout-c9173ec0898b2734.js\"],\"\"]\nb:I[6130,[],\"\"]\n6:[\"slug\",\"250106_commit\",\"d\"]\nc:[]\n"])</script><script>self.__next_f.push([1,"0:[\"$\",\"$L2\",null,{\"buildId\":\"RXy6EsBE1La1Foi2c_t5-\",\"assetPrefix\":\"\",\"urlParts\":[\"\",\"commit-logs\",\"250106_commit\"],\"initialTree\":[\"\",{\"children\":[\"commit-logs\",{\"children\":[[\"slug\",\"250106_commit\",\"d\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":\\\"250106_commit\\\"}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"commit-logs\",{\"children\":[[\"slug\",\"250106_commit\",\"d\"],{\"children\":[\"__PAGE__\",{},[[\"$L3\",\"$L4\",null],null],null]},[null,[\"$\",\"$L5\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"commit-logs\",\"children\",\"$6\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L7\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\"}]],null]},[null,[\"$\",\"$L5\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"commit-logs\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L7\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\"}]],null]},[[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/ec8169d84bc91095.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"$L8\",null,{\"children\":[\"$\",\"body\",null,{\"children\":[[\"$\",\"nav\",null,{\"className\":\"font-mono mx-16\",\"children\":[\"$\",\"ul\",null,{\"className\":\"relative min-h-32 mt-14 mb-10 mx-2 sm:mx-12 lg:mx-14 flex flex-col md:flex-row md:space-x-12 lg:space-x-16 space-y-1 md:space-y-0 justify-center md:justify-start items-start sm:items-center md:items-center text-2xl md:text-3xl z-0 tracking-tight text-zinc-900 pl-4 sm:pl-0\",\"children\":[[\"$\",\"li\",null,{\"children\":[\"$\",\"$L9\",null,{\"href\":\"/\",\"children\":\"Home\"}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"$L9\",null,{\"href\":\"/learning-logs\",\"children\":\"Learning Logs\"}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"$L9\",null,{\"href\":\"/commit-logs\",\"children\":\"Commit Logs\"}]}]]}]}],[\"$\",\"div\",null,{\"className\":\"flex justify-center py-10\",\"children\":[\"$\",\"div\",null,{\"className\":\"page-background\",\"children\":[\"$\",\"$L5\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L7\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[]}]}]}]]}]}]}]],null],null],\"couldBeIntercepted\":false,\"initialHead\":[null,\"$La\"],\"globalErrorComponent\":\"$b\",\"missingSlots\":\"$Wc\"}]\n"])</script><script>self.__next_f.push([1,"a:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"Spaceofin Logs\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"A blog for study logs\"}],[\"$\",\"link\",\"4\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"256x256\"}]]\n3:null\n"])</script><script>self.__next_f.push([1,"4:[\"$\",\"div\",null,{\"className\":\"flex flex-col prose dark:prose-invert w-full h-full max-h-none overflow-visible px-4\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"my-20 text-4xl\",\"children\":\"리액트 JS 프로젝트(animal-friends) 리팩토링\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"프로젝트 주소\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"https://animal-friends-ts.netlify.app\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"animal freidns 애플리케이션은 React 학습 후 처음 만든 포트폴리오 프로젝트입니다.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"CRA로 생성한 React JS 프로젝트이며 기능이 작동하는 것에 주안점을 두고 구축하다 보니 내부 구조가 좋지 못했습니다. 애플리케이션의 더 매끄러운 작동을 위해 리팩토링을 하기로 합니다.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"리팩토링 과정은 아래의 단계로 진행하였습니다.\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"1. Vite 프로젝트 생성 및 환경 변수 수정\\n2. javascript 파일들을 typescript 파일로 변환(일단 작동하게만)\\n3. UserContext과 useAuth hook 코드 정리\\n\"}]}],\"\\n\",[\"$\",\"h2\",null,{\"className\":\"mt-20 text-3xl text-blue-900\",\"children\":\"1. Vite 프로젝트 생성 및 환경 변수 수정\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"기존의 프로젝트는 CRA으로 만든 프로젝트였으나 리팩토링 프로젝트는 Vite를 사용하였습니다.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"REACT_APP_\"}],\"으로 시작하던 환경 변수들을 \",[\"$\",\"code\",null,{\"children\":\"VITE_\"}],\"로 시작하도록, \",[\"$\",\"code\",null,{\"children\":\"process.env.\"}],\" 접두어를 붙여 사용하던 환경 변수들은 \",[\"$\",\"code\",null,{\"children\":\"import.meta.env.\"}],\" 접두어를 사용하도록 수정하였습니다.\"]}],\"\\n\",[\"$\",\"h2\",null,{\"className\":\"mt-20 text-3xl text-blue-900\",\"children\":\"2. javascript 파일들을 typescript 파일로 변환\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"프로젝트 내 \",[\"$\",\"code\",null,{\"children\":\"js\"}],\", \",[\"$\",\"code\",null,{\"children\":\"jsx\"}],\" 파일들의 확장자를 \",[\"$\",\"code\",null,{\"children\":\"ts\"}],\", \",[\"$\",\"code\",null,{\"children\":\"tsx\"}],\" 확장자로 변경하였으며, 타입스크립트 파일들 내에 필요한 타입들을 추가해주었습니다.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"파일 확장자 변경 후 코드 수정이 필요했던 부분들은 다음과 같습니다.\"}],\"\\n\",[\"$\",\"h3\",null,{\"className\":\"text-2xl dark:text-2xl text-sky-700 dark:text-sky-300\",\"children\":\"import 구문에서 확장자 없는 json 파일을 인식하지 못하는 문제\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"기존 프로젝트는 commonJS 모듈 방식의 프로젝트였고, 새로 생성한 Vite 프로젝트는 ESM 방식의 모듈 시스템을 사용합니다.\",[\"$\",\"br\",null,{}],\"\\n\",\"Vite의 경우'.mjs', '.js', '.mts', '.ts', '.jsx', '.tsx', '.json' 확장자를 생략하여도 자동으로 파일을 인식하지만 타입스크립트 프로젝트인 경우에는 '.ts', '.tsx' 확장자 인식이 가능하며 \",[\"$\",\"code\",null,{\"children\":\".json\"}],\"이나 \",[\"$\",\"code\",null,{\"children\":\".css\"}],\" 등과 같은 이외의 확장자는 필수로 명시해주어야 합니다.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\".json\"}],\" 확장자를 명시적으로 import 구문에 추가합니다.\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"// before\\nimport demoDetails from \\\"data/demoDetails\\\";\\n\"}]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"// after\\nimport demoDetails from \\\"data/demoDetails.json\\\";\\n\"}]}],\"\\n\",[\"$\",\"h3\",null,{\"className\":\"text-2xl dark:text-2xl text-sky-700 dark:text-sky-300\",\"children\":\"Vite 프로젝트에서 svg 파일을 사용하기 위한 설정 추가\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"svgr\"}],\"이 내장되어 있던 CRA 프로젝트와 달리 Vite 프로젝트의 경우 svg 파일의 사용을 위해 svgr를 따로 설치해야 합니다.\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"// vite-plugin-svgr 설치\\nnpm install --save-dev vite-plugin-svgr\\n\"}]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"// vite.config.ts\\n...\\nimport svgr from \\\"vite-plugin-svgr\\\";\\n\\nexport default defineConfig({\\n  plugins: [..., svgr()],\\n});\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"또한 CRA 프로젝트 에서는 \",[\"$\",\"code\",null,{\"children\":\"ReactComponent\"}],\"라는 이름으로 named export를 진행하였으나, Vite 프로젝트에서는 svg를 default export 방식으로 사용하며 파일명 끝에 \",[\"$\",\"code\",null,{\"children\":\"?react\"}],\" 라는 쿼리 파라미터를 붙여 svgr 적용을 요청합니다.\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"// CRA\\nexport { ReactComponent as Logout } from \\\"./sidebar/logout.svg\\\";\\n\\n// Vite\\nexport { default as Logout } from \\\"./sidebar/logout.svg?react\\\";\\n\"}]}],\"\\n\",[\"$\",\"h2\",null,{\"className\":\"mt-20 text-3xl text-blue-900\",\"children\":\"3. UserContext과 useAuth hook 코드 정리\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"기존 코드에서의 문제점은 auth 관련 로직이 UserContext와 useAuth hook에 섞여 정리가 되어 있지 않았다는 점입니다. 또한 userContext에서 불필요하게 많은 변수를 사용하고 있었으며, user 정보에 포함되는 중복 변수들도 있었습니다.\"}],\"\\n\",[\"$\",\"h3\",null,{\"className\":\"text-2xl dark:text-2xl text-sky-700 dark:text-sky-300\",\"children\":\"3-1. UserContext 코드 정리\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"먼저 UserContext 파일의 코드를 정리해줍니다.\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"// before\\nexport const UserProvider = ({ children }: { children: React.ReactNode }) =\u003e {\\n\\t...\\n\\treturn (\\n\\t\\t\u003cUserContext.Provider\\n\\t\\t      value={{\\n\\t\\t        user,\\n\\t\\t        setUser,\\n\\t\\t        userLogin,\\n\\t\\t        userLogout,\\n\\t\\t        profileAnimal,\\n\\t\\t        setProfileAnimal,\\n\\t\\t        postCount,\\n\\t\\t        friendsCount,\\n\\t\\t        setNewDisplayName,\\n\\t\\t        createUserDoc,\\n\\t\\t        updateUserCollectionData,\\n\\t\\t        likePosts,\\n\\t\\t      }}\u003e\\n\\t\\t    {children}\\n\\t\\t\u003c/UserContext.Provider\u003e\\n\\t);\\n};\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"코드를 리팩토링하면서 UserContext에서는 로그인한 유저 정보와 현재 로그인한 상태인지만 다루도록 하였습니다.\",[\"$\",\"br\",null,{}],\"\\n\",\"user 데이터와 중복되는 값들은 없애고 user 값에서만 데이터를 갖다 쓰도록 하였습니다.\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"// after\\nexport const UserProvider = ({ children }: { children: React.ReactNode }) =\u003e {\\n\\t...\\n\\treturn (\\n\\t    \u003cUserContext.Provider value={{ user, setUser, isLoggedIn }}\u003e\\n\\t      {children}\\n\\t    \u003c/UserContext.Provider\u003e\\n\\t);\\n};\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"이 과정에서 userContext 파일 내에서 함께 처리하던 User 정보와 관련된 로직들은 별도의 userService 파일을 생성하여 모아 두었습니다.\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"// userServices.ts\\n\\nconst getUserDocumentByUid = async (userId: string) =\u003e { ... };\\nexport const createUser = async ({ ... });\\nexport const getUser = async (userId: string) =\u003e { ... };\\nexport const updateUserProfileAnimal = async (uid: string, profileAnimal: string) =\u003e { ... };\\nexport const updateUserName = async (uid: string, userName: string) =\u003e { ... };\\nexport const updateUserLikePosts = async (uid: string, likePosts: string[]) =\u003e { ... };\\n\\n\"}]}],\"\\n\",[\"$\",\"h3\",null,{\"className\":\"text-2xl dark:text-2xl text-sky-700 dark:text-sky-300\",\"children\":\"3-2. useAuth hook 코드 정리\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"먼저, 유저의 로그인 상태에 대한 정보는 UserContext에서 관리하도록 하였으므로 useAuth hook에서는 삭제하였습니다.(\",[\"$\",\"code\",null,{\"children\":\"isLoggedIn\"}],\")\",[\"$\",\"br\",null,{}],\"\\n\",\"또한 프로젝트에 기존 useAuth hook에서는 이메일 로그인 로직만을 다루며 social login의 경우 login 페이지의 코드에서 수행하였으나 리팩토링 하며 로그인 관련 로직들을 모아서 useAuth hook에 정리하였습니다.\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"// before \\nexport const useAuth = () =\u003e {\\n\\tconst { user, setUser } = useUser();\\n\\t...\\n\\n\\tconst isLoggedIn = user !== null;\\n\\tconst login = async (email, password) =\u003e {\\n\\t\\t// email-password login logic\\n\\t\\t...\\n\\t}\\n\\t...\\n\\t\\n\\treturn { user, login, logout, isLoggedIn };\\n}\\n\"}]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"// after\\nexport const useAuth = () =\u003e {\\n\\tconst { setUser } = useUser();\\n\\t...\\n\\n\\tconst loginWithEmail = async (email: string, password: string) =\u003e {\\n\\t\\t// email-password login logic\\n\\t\\t...\\n\\t}\\n\\tconst loginWithSocial = async (authProvider: string) =\u003e {\\n\\t\\t// social login logic\\n\\t\\t...\\n\\t}\\n\\n\\treturn { loginWithEmail, loginWithSocial, logout };\\n}\\n\"}]}],\"\\n\",[\"$\",\"h3\",null,{\"className\":\"text-2xl dark:text-2xl text-sky-700 dark:text-sky-300\",\"children\":\"3-3. UserContext와 useAuth hook을 사용하는 관련 코드 업데이트\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"변경된 UserContext와 useAuth hook에 맞게 관련 코드들도 수정하였습니다.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"useAuth로부터 가져다 쓰던 로그인 상태 확인 로직을 useUser를 사용하도록 변경하였습니다.\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"// before\\nconst { isLoggedIn } = useAuth();\\n\\n// after\\nconst { isLoggedIn } = useUser();\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"useAuth로부터 email-password 방식의 로그인 함수만 가져오고 social login은 해당 페이지에서 구현하던 방식을 두 가지 방식의 로그인 함수 다 useAuth 로부터 가져다 쓰도록 변경하였습니다.\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"// before\\nconst { login } = useAuth();\\n\\n// after\\nconst { loginWithEmail, loginWithSocial } = useAuth();\\n\"}]}],\"\\n\",[\"$\",\"h2\",null,{\"className\":\"mt-20 text-3xl text-blue-900\",\"children\":\"reference\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"https://vite.dev/config/shared-options.html#resolve-extensions\\n\"}]}]]}]\n"])</script></body></html>